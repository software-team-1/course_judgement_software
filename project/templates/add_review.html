{% extends 'log_sign/base.html' %}
{% load static %}
{% block title %}judgement{% endblock %}
{% block css %}
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
    <script src="//cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link href="{% static 'css/search_result.css' %}" rel="stylesheet"/>
    <link href="{% static 'bootstrap/css/star-rating.css'%}" media="all" rel="stylesheet" type="text/css"/>
    <script src="{% static 'bootstrap/js/star-rating.js'%}" type="text/javascript"></script>
{% endblock %}

{% block content %}
    {% if courses %}
        <div class="picture">
            <img src={% static "/img/blue.png" %} alt="校徽">
        </div>
    {% for course in courses %}
        <div class="col-md-8 col-md-offset-2" id="content-box" >
            <div class="panel-group" id="accordion{{ course.id }}" >
                <div class="panel panel-default" >
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a id= "course-info" data-toggle="collapse" data-parent="#accordion{{course.id}}"  href="#collapse{{ course.id }}">
                                <table class="title" style="table-layout: fixed;">
                                    <tr>
                                        <td>课程：{{ course.name }}</td>
                                        <td>老师：{{ course.teacher }}</td>
                                        <td>类别：{{ course.type }}</td>
                                        <td>学分：{{ course.credit }}</td>
                                    </tr>
                                </table>
                            </a>
                        </h4>
                    </div>

                    <div id="collapse{{ course.id }}"  class="panel-collapse collapse in">
                        <div class="panel-body">
                            <ul class="list-group">
                                {% for key, judges in judgement.items %}
                                    {% if key == course.id %}
                                        {% for judge in judges %}
                                            <table class="table table-bordered" style="table-layout: fixed;margin-top: 20px;">
                                                <tr>
                                                    <td colspan="3">
                                                        <span class="emphasize">评论{{ judge.judgement_id }}</span>
                                                        <span class="date"><small>编辑于：{{ judge.create_date }}</small></span>
                                                </tr>
                                                <tr>
                                                    <td colspan="1">
                                                        <span class="emphasize">硬核指数：</span>
                                                        <input id="star1" name="testName" class="rating-show"  min="0" max="10" data-size="15" value={{ judge.hard_core_mark }}>
                                                    </td>
                                                    <td colspan="1">
                                                        <span class="emphasize">兴趣指数：</span>
                                                        <input id="star2" name="testName" class="rating-show"  min="0" max="10" data-size="15" value={{ judge.mark_of_interest }}>
                                                    </td>
                                                    <td colspan="1">
                                                        <span class="emphasize">推荐指数：</span>
                                                        <input id="star3" name="testName" class="rating-show"  min="0" max="10" data-size="15" value={{ judge.recommend_mark }}>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3">
                                                        <button type="button" class="btn btn-default btn-lg" id="icon1" style="color: cadetblue">
                                                            <span class="glyphicon glyphicon-pencil"></span> 课程评价 </button>
                                                        {{ judge.comment_of_the_course }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3">
                                                        <button type="button" class="btn btn-default btn-lg" id="icon2" style="color: #2aabd2">
                                                            <span class="glyphicon glyphicon-user"></span> 老师评价 </button>
                                                        {{ judge.comment_of_the_teacher }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3">
                                                        <button type="button" class="btn btn-default btn-lg" id="icon3" style="color: steelblue">
                                                            <span class="glyphicon glyphicon-list-alt"></span> 成绩构成 </button>
                                                        {{ judge.the_constitution_of_grade }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3">
                                                        <button type="button" class="btn btn-default btn-lg" id="icon4" style="color: rgba(0,0,139,0.8)">
                                                            <span class="glyphicon glyphicon-time"></span> 作业估时 </button>
                                                        {{ judge.time_for_homework }}
                                                    </td>
                                                </tr>
                                            </table>
                                        {% endfor %}
                                    {% endif %}
                                {% endfor %}
                                <table class="table table-bordered" style="table-layout: fixed;margin-top: 20px;">
                                    <form action="/add_judgement/submit" method="post">
                                        <tr>
                                            <script>f({{ course.id }})</script>
                                            <td colspan="1">
                                                <span class="emphasize">硬核指数：</span>
                                                <input id="star4" name="testName" class="rating"  min="0" max="10" data-size="15" value="0">
                                            </td>
                                            <td colspan="1">
                                                <span class="emphasize">兴趣指数：</span>
                                                <input id="star5" name="testName" class="rating"  min="0" max="10" data-size="15" value="0">
                                            </td>
                                            <td colspan="1">
                                                <span class="emphasize">推荐指数：</span>
                                                <input id="star6" name="testName" class="rating"  min="0" max="10" data-size="15" value="0">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                <button type="button" class="btn btn-default btn-lg" id="icon1" style="color: cadetblue">
                                                    <span class="glyphicon glyphicon-pencil"></span> 课程评价 </button>
                                                <input type="text" name="comment_of_the_course">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                <button type="button" class="btn btn-default btn-lg" id="icon2" style="color: #2aabd2">
                                                    <span class="glyphicon glyphicon-user"></span> 老师评价 </button>
                                                <input type="text" name="comment_of_the_teacher">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                <button type="button" class="btn btn-default btn-lg" id="icon3" style="color: steelblue">
                                                    <span class="glyphicon glyphicon-list-alt"></span> 成绩构成 </button>
                                                <input type="text" name="the_constitution_of_grade ">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                <button type="button" class="btn btn-default btn-lg" id="icon4" style="color: rgba(0,0,139,0.8)">
                                                    <span class="glyphicon glyphicon-time"></span> 作业估时 </button>
                                                <input type="text" name="time_for_homework">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                <input type="submit" value="submit">
                                            </td>
                                        </tr>
                                    </form>
                                </table>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}

{% else %}
    <p class="error"> 没有找到对应的课程！ </p>
{% endif %}
    <div class="col-md-4 col-md-offset-4" id="pic-box">

    </div>
    <script>
        $('.rating').rating({
            min: 0, /*星星的最小数值*/
            max: 10, /*星星的最大数值*/
            step: 1, /*表示增加减少的数量*/
            size: 'xs', /*星星的大小 有lg,sm,xl,xs*/
            showClear: false, /*是否显示清除按钮*/
            {#disabled: true, /*不可用设置 默认false可以点击  true禁止点击*/#}
            {#readonly:true,  /*只读模式 跟上面一样效果，不知道啥区别*/#}
            {#starCaptions: {1: '1分 太坑', 2: '2分 凑合', 3: '3分 一般', 4: '4分 很好', 5: '5分 非常好'},#}
            {#starCaptionClasses: {1: 'text-danger', 2: 'text-warning', 3: 'text-info', 4: 'text-primary', 5: 'text-success'}#}
            showCaptionAsTitle: false,
            showCaption: false,
        });

        $('.rating-show').rating({
            min: 0, /*星星的最小数值*/
            max: 10, /*星星的最大数值*/
            step: 1, /*表示增加减少的数量*/
            size: 'xs', /*星星的大小 有lg,sm,xl,xs*/
            showClear: false, /*是否显示清除按钮*/
            disabled: true, /*不可用设置 默认false可以点击  true禁止点击*/
            {#readonly:true,  /*只读模式 跟上面一样效果，不知道啥区别*/#}
            {#starCaptions: {1: '1分 太坑', 2: '2分 凑合', 3: '3分 一般', 4: '4分 很好', 5: '5分 非常好'},#}
            {#starCaptionClasses: {1: 'text-danger', 2: 'text-warning', 3: 'text-info', 4: 'text-primary', 5: 'text-success'}#}
            showCaptionAsTitle: false,
            showCaption: false,
        });

        /*这里是更改评分后，星星的打分显示 .rating('update',3)这样*/
        {#$('.rating1').rating({ }).rating('update',3);#}
        {#$('.rating2').rating({ }).rating('update',2);#}
        {#$('.rating3').rating({ }).rating('update',4);#}
        {#$('.rating4').rating({ }).rating('update',5);#}
    </script>

    <script>
        function f(id) {
            var course_id = id;    //获取要传到后台的数据
        $.ajax({
            type: "POST",
            url: "add_judgement/submit/",    //后台处理函数的url
            data: course_id,
            success: function (result) {  //获取后台处理后传过来的result
                alert(result)
            },
        });
        }
    </script>

{% endblock %}
